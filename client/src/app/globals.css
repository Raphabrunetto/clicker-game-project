@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
  --stage-cta-primary-1: #16a34a;
  --stage-cta-primary-2: #0284c7;
  --stage-cta-primary-3: #4338ca;
  --stage-cta-primary-shadow: 0 18px 40px rgba(59, 130, 246, 0.52);
  --stage-cta-primary-shadow-hover: 0 24px 56px rgba(59, 130, 246, 0.62);
  --stage-cta-secondary-1: #0284c7;
  --stage-cta-secondary-2: #4338ca;
  --stage-cta-secondary-shadow: 0 14px 32px rgba(59, 130, 246, 0.4);
  --stage-cta-secondary-shadow-hover: 0 20px 44px rgba(129, 140, 248, 0.5);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* --- Simple, lightweight animation utilities for game feedback --- */
@keyframes anim-pop-scale {
  0% { transform: scale(1); }
  50% { transform: scale(1.08); }
  100% { transform: scale(1); }
}

@keyframes anim-shake-x {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-6px); }
  40% { transform: translateX(6px); }
  60% { transform: translateX(-4px); }
  80% { transform: translateX(4px); }
}

@keyframes anim-glow {
  0%, 100% { box-shadow: 0 0 0 rgba(0,0,0,0); }
  50% { box-shadow: 0 0 24px rgba(99,102,241,0.45); }
}

@keyframes anim-float-up {
  0% { opacity: 1; transform: translateY(0) scale(0.95); }
  100% { opacity: 0; transform: translateY(-28px) scale(1.08); }
}

.anim-pop { animation: anim-pop-scale 180ms ease-out; }
.anim-shake { animation: anim-shake-x 420ms ease-in-out; }
.anim-glow { animation: anim-glow 1200ms ease-in-out; }
.anim-float-up { animation: anim-float-up 750ms ease-out forwards; }

/* Confetti pieces using CSS variables for direction/rotation */
@keyframes anim-confetti {
  0% { opacity: 1; transform: translate(0, 0) rotate(0deg); }
  100% { opacity: 0; transform: translate(var(--dx, 0px), var(--dy, -80px)) rotate(var(--rot, 360deg)); }
}
.confetti-piece {
  position: absolute;
  width: 6px;
  height: 8px;
  border-radius: 1px;
  animation: anim-confetti 900ms ease-out forwards;
  will-change: transform, opacity;
}

/* --- Auth Card entrance + hover animation (non-intrusive) --- */
@keyframes auth-card-in {
  0% { opacity: 0; transform: translateY(8px) scale(0.98); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}
.auth-card {
  animation: auth-card-in 220ms ease-out both;
}

/* ---- Dynamic Stage Theming ---- */
/* Animated gradient background layer */
@keyframes bg-pan {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  background: var(--tier-bg, radial-gradient(1200px 800px at 10% 10%, #0b0b0b, #000));
  background-size: 160% 160%;
  animation: bg-pan 18s ease-in-out infinite;
  opacity: 0.85;
}

/* Subtle transition when variables change */
html, body, [data-slot="card"], [data-slot="button"], [data-slot="input"] {
  transition: background-color 300ms ease, color 300ms ease, border-color 300ms ease, box-shadow 300ms ease;
}

/* Stage change burst */
.tier-burst::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(600px 600px at center, rgba(255,255,255,0.08), transparent 60%);
  animation: auth-card-in 600ms ease-out;
}

/* Shimmer progress bar */
@keyframes shimmer-move {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}
.shimmer-bar {
  background-image: linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.8), rgba(255,255,255,0.15));
  background-size: 200% 100%;
  animation: shimmer-move 1.2s linear infinite;
  box-shadow: 0 0 18px rgba(255,255,255,0.25);
}

/* Milestone overlay */
@keyframes overlay-in {
  0% { opacity: 0; transform: translateY(12px) scale(0.98); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}
.milestone-overlay > div > div {
  animation: overlay-in 260ms ease-out;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 0.25;
  }
  50% {
    opacity: 0.9;
  }
}

@keyframes orb-drift {
  0% {
    transform: translate3d(-6%, -4%, 0) scale(0.92);
  }
  50% {
    transform: translate3d(4%, 6%, 0) scale(1.05);
  }
  100% {
    transform: translate3d(-6%, 4%, 0) scale(0.95);
  }
}

@keyframes orb-rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes halo-pulse {
  0%,
  100% {
    opacity: 0.45;
    transform: scale(0.94);
  }
  50% {
    opacity: 0.9;
    transform: scale(1.05);
  }
}

@keyframes halo-ring {
  0% {
    opacity: 0.6;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(1.4);
  }
}

.orb-field {
  position: absolute;
  inset: 0;
  overflow: hidden;
  filter: saturate(140%);
}

.orb {
  position: absolute;
  border-radius: 9999px;
  background: radial-gradient(closest-side, rgba(56, 189, 248, 0.65), rgba(59, 130, 246, 0));
  mix-blend-mode: screen;
  animation: orb-drift 32s ease-in-out infinite alternate,
    orb-rotate 64s linear infinite;
}

.orb--emerald {
  background: radial-gradient(closest-side, rgba(16, 185, 129, 0.65), rgba(16, 185, 129, 0));
}

.orb--violet {
  background: radial-gradient(closest-side, rgba(168, 85, 247, 0.6), rgba(168, 85, 247, 0));
}

.orb--amber {
  background: radial-gradient(closest-side, rgba(245, 158, 11, 0.55), rgba(245, 158, 11, 0));
}

.glass-panel {
  position: relative;
  overflow: hidden;
  border-radius: 18px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  background: linear-gradient(135deg, rgba(8, 47, 73, 0.42), rgba(15, 23, 42, 0.18));
  box-shadow: 0 18px 40px rgba(12, 74, 110, 0.22);
  backdrop-filter: blur(30px) saturate(140%);
}

.glass-panel::before {
  content: '';
  position: absolute;
  inset: -40% -20%;
  background: radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.25), transparent 60%),
    radial-gradient(circle at 80% 10%, rgba(14, 165, 233, 0.15), transparent 55%);
  opacity: 0.55;
  filter: blur(26px);
}

.glass-panel::after {
  content: '';
  position: absolute;
  inset: -30% 10%;
  background: radial-gradient(circle at 50% 0%, rgba(16, 185, 129, 0.16), transparent 60%);
  filter: blur(24px);
}

.glass-panel > * {
  position: relative;
  z-index: 1;
}

.stat-card {
  position: relative;
  overflow: hidden;
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  background: linear-gradient(160deg, rgba(15, 23, 42, 0.48), rgba(8, 145, 178, 0.18));
  padding: 1rem 1.25rem;
  box-shadow: 0 16px 36px rgba(8, 47, 73, 0.25);
  backdrop-filter: blur(22px) saturate(135%);
  transition: transform 0.4s ease, box-shadow 0.4s ease, border-color 0.4s ease;
}

.stat-card::before {
  content: '';
  position: absolute;
  inset: -20% -30%;
  background: conic-gradient(from 120deg, rgba(59, 130, 246, 0.4), rgba(94, 234, 212, 0.25), rgba(59, 130, 246, 0.4));
  opacity: 0.35;
  filter: blur(40px);
  transition: opacity 0.4s ease;
}

.stat-card:hover {
  transform: translateY(-4px) scale(1.01);
  border-color: rgba(125, 211, 252, 0.55);
  box-shadow: 0 24px 50px rgba(14, 165, 233, 0.45);
}

.stat-card:hover::before {
  opacity: 0.6;
}

.click-halo {
  position: relative;
  display: inline-flex;
  padding: 3px;
  border-radius: 999px;
  isolation: isolate;
}

.click-halo::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: radial-gradient(circle at 50% 50%, rgba(56, 189, 248, 0.6), rgba(56, 189, 248, 0));
  filter: blur(12px);
  opacity: 0.65;
  animation: halo-pulse 4s ease-in-out infinite;
  z-index: -1;
}

.click-halo::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  border: 1px solid rgba(125, 211, 252, 0.5);
  animation: halo-ring 2.6s ease-out infinite;
  pointer-events: none;
}

.click-halo .click-halo__ring {
  position: absolute;
  inset: -20%;
  border-radius: inherit;
  background: radial-gradient(circle at 50% 50%, rgba(34, 197, 94, 0.45), transparent 70%);
  filter: blur(28px);
  opacity: 0;
  transition: opacity 0.25s ease-out;
  z-index: -1;
}

.click-halo.is-active .click-halo__ring {
  opacity: 1;
}

.stage-cta {
  color: #fff;
  background-color: transparent;
  background-size: 220% 220%;
  border: none;
  filter: saturate(1.15);
  transition: transform 180ms ease, box-shadow 220ms ease, filter 180ms ease, background-position 260ms ease;
}

.stage-cta-primary {
  background-image: linear-gradient(135deg, var(--stage-cta-primary-1), var(--stage-cta-primary-2), var(--stage-cta-primary-3));
  box-shadow: var(--stage-cta-primary-shadow);
}

.stage-cta-primary:hover {
  box-shadow: var(--stage-cta-primary-shadow-hover);
  filter: saturate(1.3) brightness(1.02);
  background-position: 70% 50%;
}

.stage-cta-secondary {
  background-image: linear-gradient(135deg, var(--stage-cta-secondary-1), var(--stage-cta-secondary-2));
  box-shadow: var(--stage-cta-secondary-shadow);
}

.stage-cta-secondary:hover {
  box-shadow: var(--stage-cta-secondary-shadow-hover);
  filter: saturate(1.28) brightness(1.02);
  background-position: 30% 50%;
}

.stage-cta:disabled,
.stage-cta[aria-disabled='true'] {
  filter: saturate(0.65) brightness(0.88);
  box-shadow: none;
}

/* Stage theme band variables selecting dramatic scenes. */
body[data-theme-band='noir'] {
  --background: oklch(0.13 0.03 260);
  --foreground: oklch(0.98 0 0);
  --card: oklch(0.18 0.03 260);
  --card-foreground: oklch(0.98 0 0);
  --primary: oklch(0.78 0.12 220);
  --accent: oklch(0.5 0.12 270);
  --tier-bg: radial-gradient(1400px 900px at 15% 10%, #10121a, #020617 70%);
}

body[data-theme-band='mirage'] {
  --background: oklch(0.24 0.07 70);
  --foreground: oklch(0.99 0 0);
  --card: oklch(0.29 0.06 70);
  --card-foreground: oklch(0.99 0 0);
  --primary: oklch(0.82 0.19 80);
  --accent: oklch(0.74 0.16 330);
  --tier-bg: radial-gradient(1400px 900px at 80% 20%, #2a1725, #12060f 60%);
}

body[data-theme-band='ascension'] {
  --background: oklch(0.18 0.06 310);
  --foreground: oklch(0.99 0 0);
  --card: oklch(0.23 0.05 310);
  --card-foreground: oklch(0.99 0 0);
  --primary: oklch(0.86 0.2 290);
  --accent: oklch(0.78 0.16 210);
  --tier-bg: radial-gradient(1600px 1000px at 50% -10%, #150238, #04020d 75%);
}

/* Stage tier palettes feed the button styling. */
body[data-tier='bronze'] {
  --stage-cta-primary-1: #fbbf24;
  --stage-cta-primary-2: #f59e0b;
  --stage-cta-primary-3: #f97316;
  --stage-cta-primary-shadow: 0 20px 48px rgba(249, 115, 22, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 68px rgba(249, 115, 22, 0.66);
  --stage-cta-secondary-1: #f97316;
  --stage-cta-secondary-2: #fb923c;
  --stage-cta-secondary-shadow: 0 16px 38px rgba(251, 146, 60, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 44px rgba(251, 146, 60, 0.58);
}

body[data-tier='silver'] {
  --stage-cta-primary-1: #f4f4f5;
  --stage-cta-primary-2: #cbd5f5;
  --stage-cta-primary-3: #94a3b8;
  --stage-cta-primary-shadow: 0 20px 48px rgba(148, 163, 184, 0.5);
  --stage-cta-primary-shadow-hover: 0 26px 62px rgba(148, 163, 184, 0.65);
  --stage-cta-secondary-1: #a5b4fc;
  --stage-cta-secondary-2: #cbd5f5;
  --stage-cta-secondary-shadow: 0 16px 36px rgba(165, 180, 252, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 44px rgba(165, 180, 252, 0.58);
}

body[data-tier='gold'] {
  --stage-cta-primary-1: #fde047;
  --stage-cta-primary-2: #fbbf24;
  --stage-cta-primary-3: #f59e0b;
  --stage-cta-primary-shadow: 0 20px 52px rgba(251, 191, 36, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 72px rgba(251, 191, 36, 0.68);
  --stage-cta-secondary-1: #facc15;
  --stage-cta-secondary-2: #f97316;
  --stage-cta-secondary-shadow: 0 16px 40px rgba(250, 204, 21, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 48px rgba(249, 115, 22, 0.6);
}

body[data-tier='emerald'] {
  --stage-cta-primary-1: #5eead4;
  --stage-cta-primary-2: #34d399;
  --stage-cta-primary-3: #059669;
  --stage-cta-primary-shadow: 0 20px 50px rgba(16, 185, 129, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 70px rgba(16, 185, 129, 0.7);
  --stage-cta-secondary-1: #34d399;
  --stage-cta-secondary-2: #2dd4bf;
  --stage-cta-secondary-shadow: 0 16px 38px rgba(45, 212, 191, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 46px rgba(45, 212, 191, 0.6);
}

body[data-tier='sapphire'] {
  --stage-cta-primary-1: #38bdf8;
  --stage-cta-primary-2: #0ea5e9;
  --stage-cta-primary-3: #2563eb;
  --stage-cta-primary-shadow: 0 20px 54px rgba(37, 99, 235, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 74px rgba(37, 99, 235, 0.7);
  --stage-cta-secondary-1: #38bdf8;
  --stage-cta-secondary-2: #6366f1;
  --stage-cta-secondary-shadow: 0 16px 40px rgba(99, 102, 241, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 50px rgba(99, 102, 241, 0.6);
}

body[data-tier='ruby'] {
  --stage-cta-primary-1: #fb7185;
  --stage-cta-primary-2: #f43f5e;
  --stage-cta-primary-3: #be123c;
  --stage-cta-primary-shadow: 0 20px 48px rgba(244, 63, 94, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 68px rgba(244, 63, 94, 0.72);
  --stage-cta-secondary-1: #f472b6;
  --stage-cta-secondary-2: #f43f5e;
  --stage-cta-secondary-shadow: 0 16px 38px rgba(244, 114, 182, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 46px rgba(244, 114, 182, 0.6);
}

body[data-tier='amethyst'] {
  --stage-cta-primary-1: #d8b4fe;
  --stage-cta-primary-2: #c084fc;
  --stage-cta-primary-3: #8b5cf6;
  --stage-cta-primary-shadow: 0 20px 52px rgba(129, 140, 248, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 70px rgba(129, 140, 248, 0.72);
  --stage-cta-secondary-1: #a855f7;
  --stage-cta-secondary-2: #6366f1;
  --stage-cta-secondary-shadow: 0 16px 38px rgba(168, 85, 247, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 48px rgba(168, 85, 247, 0.6);
}

body[data-tier='obsidian'] {
  --stage-cta-primary-1: #22d3ee;
  --stage-cta-primary-2: #0ea5e9;
  --stage-cta-primary-3: #312e81;
  --stage-cta-primary-shadow: 0 20px 52px rgba(14, 165, 233, 0.55);
  --stage-cta-primary-shadow-hover: 0 26px 72px rgba(14, 165, 233, 0.7);
  --stage-cta-secondary-1: #22d3ee;
  --stage-cta-secondary-2: #6366f1;
  --stage-cta-secondary-shadow: 0 16px 38px rgba(56, 189, 248, 0.45);
  --stage-cta-secondary-shadow-hover: 0 22px 48px rgba(56, 189, 248, 0.6);
}

body[data-tier='neon'] {
  --stage-cta-primary-1: #22d3ee;
  --stage-cta-primary-2: #a855f7;
  --stage-cta-primary-3: #f97316;
  --stage-cta-primary-shadow: 0 20px 56px rgba(168, 85, 247, 0.58);
  --stage-cta-primary-shadow-hover: 0 26px 78px rgba(34, 211, 238, 0.72);
  --stage-cta-secondary-1: #a855f7;
  --stage-cta-secondary-2: #22d3ee;
  --stage-cta-secondary-shadow: 0 16px 42px rgba(168, 85, 247, 0.5);
  --stage-cta-secondary-shadow-hover: 0 22px 52px rgba(168, 85, 247, 0.65);
}

/* Stage backdrop styling lives below */
.stage-backdrop {
  position: absolute;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 0;
}

.stage-backdrop > * {
  position: absolute;
}

.stage-backdrop--noir .stage-noir__base {
  position: absolute;
  inset: -18%;
  background:
    radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.18), transparent 55%),
    radial-gradient(circle at 80% 15%, rgba(45, 212, 191, 0.16), transparent 60%),
    linear-gradient(165deg, rgba(3, 7, 18, 0.95), rgba(2, 6, 23, 0.92));
  filter: blur(26px);
  opacity: 0.9;
  animation: stage-noir-breathe 28s ease-in-out infinite;
}

.stage-backdrop--noir .stage-noir__vignette {
  position: absolute;
  inset: -10%;
  background: radial-gradient(circle at center, rgba(2, 6, 23, 0) 40%, rgba(2, 6, 23, 0.75) 75%, rgba(2, 6, 23, 0.95) 100%);
  mix-blend-mode: screen;
}

.stage-backdrop--noir .stage-noir__confetti-layer {
  position: absolute;
  inset: -10%;
}

.stage-backdrop--noir .stage-noir__confetti {
  position: absolute;
  width: 92px;
  height: 30px;
  border-radius: 999px;
  filter: blur(20px);
  opacity: 0;
  animation: stage-noir-confetti 18s linear infinite;
  animation-delay: var(--delay, 0s);
  mix-blend-mode: screen;
}

.stage-backdrop--noir .stage-noir__scanline {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, transparent 0%, rgba(59, 130, 246, 0.08) 50%, transparent 100%);
  mix-blend-mode: soft-light;
  opacity: 0.25;
  animation: stage-noir-scan 12s linear infinite;
}

@keyframes stage-noir-breathe {
  0%, 100% { transform: translate3d(0, 0, 0) scale(1); }
  50% { transform: translate3d(0, -1.5%, 0) scale(1.04); }
}

@keyframes stage-noir-confetti {
  0% { opacity: 0; transform: translate3d(0, 0, 0) rotate(0deg) scale(var(--scale, 1)); }
  12% { opacity: 0.45; }
  55% { opacity: 0.8; }
  100% { opacity: 0; transform: translate3d(var(--shift-x, 0px), var(--shift-y, 160px), 0) rotate(var(--twirl, 240deg)) scale(var(--scale-end, 0.85)); }
}

@keyframes stage-noir-scan {
  0% { transform: translateY(-100%); }
  100% { transform: translateY(100%); }
}

.stage-backdrop--mirage .stage-mirage__base {
  position: absolute;
  inset: -12%;
  background:
    radial-gradient(circle at 0% 0%, rgba(253, 230, 138, 0.55), rgba(253, 164, 175, 0.12) 55%),
    linear-gradient(135deg, rgba(244, 114, 182, 0.65), rgba(251, 191, 36, 0.55), rgba(56, 189, 248, 0.4));
  filter: blur(18px);
  opacity: 0.95;
}

.stage-backdrop--mirage .stage-mirage__glow {
  position: absolute;
  inset: -25%;
  background:
    radial-gradient(circle at 50% 40%, rgba(255, 255, 255, 0.18), transparent 65%),
    linear-gradient(120deg, rgba(244, 114, 182, 0.18), rgba(251, 191, 36, 0.12));
  mix-blend-mode: screen;
  animation: stage-mirage-glow 32s ease-in-out infinite;
}

.stage-backdrop--mirage .stage-mirage__ribbons {
  position: absolute;
  inset: -20% -10%;
  overflow: visible;
}

.stage-backdrop--mirage .stage-mirage__ribbon {
  position: absolute;
  border-radius: 999px;
  opacity: 0.55;
  animation: stage-mirage-ribbon 36s ease-in-out infinite;
}

.stage-backdrop--mirage .stage-mirage__bubbles {
  position: absolute;
  inset: -10%;
}

.stage-backdrop--mirage .stage-mirage__bubble {
  position: absolute;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.28);
  background: radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0));
  filter: blur(2px);
  animation: stage-mirage-bubble 24s ease-in-out infinite;
}

@keyframes stage-mirage-glow {
  0%, 100% { transform: scale(1); opacity: 0.75; }
  50% { transform: scale(1.04) translate3d(0, -2%, 0); opacity: 0.95; }
}

@keyframes stage-mirage-ribbon {
  0% { transform: rotate(var(--rotate, 0deg)) translate3d(-6%, -4%, 0) scale(1); opacity: 0.45; }
  50% { transform: rotate(var(--rotate, 0deg)) translate3d(5%, 6%, 0) scale(1.08); opacity: 0.85; }
  100% { transform: rotate(var(--rotate, 0deg)) translate3d(-6%, 9%, 0) scale(1); opacity: 0.45; }
}

@keyframes stage-mirage-bubble {
  0% { transform: translate3d(0, 0, 0) scale(0.9); opacity: 0.0; }
  12% { opacity: var(--bubble-opacity, 0.4); }
  60% { opacity: var(--bubble-opacity, 0.4); }
  100% { transform: translate3d(0, -40%, 0) scale(1.08); opacity: 0; }
}

.stage-backdrop--ascension .stage-ascension__base {
  position: absolute;
  inset: -14%;
  background:
    radial-gradient(circle at 20% -10%, rgba(59, 130, 246, 0.4), transparent 45%),
    radial-gradient(circle at 80% 0%, rgba(147, 51, 234, 0.4), transparent 55%),
    linear-gradient(180deg, rgba(2, 6, 23, 0.92), rgba(0, 0, 0, 0.94));
  filter: blur(18px);
}

.stage-backdrop--ascension .stage-ascension__nebula {
  position: absolute;
  inset: -30%;
  background:
    conic-gradient(from 120deg at 45% 35%, rgba(244, 114, 182, 0.35), rgba(56, 189, 248, 0.24), rgba(56, 189, 248, 0)),
    radial-gradient(circle at 60% 65%, rgba(59, 130, 246, 0.28), transparent 60%);
  mix-blend-mode: screen;
  animation: stage-ascension-nebula 28s linear infinite;
}

.stage-backdrop--ascension .stage-ascension__grid {
  position: absolute;
  inset: -20% -35% 0 -35%;
  background-image:
    linear-gradient(rgba(56, 189, 248, 0.22) 1px, transparent 1px),
    linear-gradient(90deg, rgba(129, 140, 248, 0.18) 1px, transparent 1px);
  background-size: 160px 160px;
  opacity: 0.28;
  transform: perspective(960px) rotateX(68deg);
  transform-origin: top center;
  animation: stage-ascension-grid 16s linear infinite;
}

.stage-backdrop--ascension .stage-ascension__stars {
  position: absolute;
  inset: 0;
  overflow: hidden;
}

.stage-backdrop--ascension .stage-ascension__star {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 999px;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0));
  box-shadow: 0 0 18px rgba(59, 130, 246, 0.65);
  animation: stage-ascension-star 4.6s ease-in-out infinite;
}

@keyframes stage-ascension-nebula {
  0% { transform: rotate(0deg) scale(1); opacity: 0.6; }
  50% { transform: rotate(12deg) scale(1.08); opacity: 0.85; }
  100% { transform: rotate(24deg) scale(1); opacity: 0.6; }
}

@keyframes stage-ascension-grid {
  0% { background-position: 0px 0px, 0px 0px; }
  100% { background-position: 0px 160px, 160px 0px; }
}

@keyframes stage-ascension-star {
  0%, 100% { opacity: 0.35; transform: translate3d(0, 0, 0) scale(var(--scale, 1)); }
  55% { opacity: 1; transform: translate3d(0, -8px, 0) scale(var(--scale-hover, 1.2)); }
}

